generator client {
  provider        = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Customer {
  id        Int      @id @default(autoincrement())
  first_name String?
  last_name  String?
  orders    Order[]
  phone_number String @unique
  nationality_id Int?

  @@map("customer")
}

model Order {
  id          Int         @id @default(autoincrement())
  order_code  String      @unique
  customer_id Int?
  comments    String?
  created_at  DateTime    @default(now())

  // Relations
  customer    Customer?   @relation(fields: [customer_id], references: [id], onDelete: Cascade)
  order_item OrderItem[]
  @@map("order")  
}

model OrderItem {
  id        Int      @id @default(autoincrement())
  order_id  Int
  quantity  Int
  dish_id   Int
  side_id   Int?
  // Relations
  order     Order    @relation(fields: [order_id], references: [id], onDelete: Cascade)
  dish      Dish     @relation(fields: [dish_id], references: [id])
  side      Side?     @relation(fields: [side_id], references: [id])

  @@map("order_item")
}

model Dish {
  id       Int    @id @default(autoincrement())
  name     String
  price    Float

  OrderItem OrderItem[]
  @@map("dish")
}

model Nationality {
  id   Int    @id @default(autoincrement())
  name String @unique

  @@map("nationality")
}

model Side {
  id   Int    @id @default(autoincrement())
  name String @unique
  cost Float
  price Float
  description String?

  OrderItem OrderItem[]
  @@map("side")
}